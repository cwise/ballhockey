<% form_for :game do|f| %>
  <table>
    <caption>Game</caption>
    <tr>
      <th>Date</th>
      <th>Status</th>
      <th>Number Playing</th>
    </tr>
    <tr>
      <% if @view_only %>
        <td><%= @game.game_date %></td>
        <td><%= @game.game_status.description %></td>
      <% else %>
        <td><%= f.date_select :game_date %></td>
        <td><%= collection_select(:game, :game_status_id, @game_statuses, :id, :description) %></td>
      <% end %>
      <td><%= @game.number_playing %></td>
    </tr>
    <tr>
      <th>Organizer</th>
      <th colspan="2">Reply To</th>
    </tr>
    <tr>
      <% if @view_only %>
        <td><%= @game.organizer  %></td>
        <td colspan="2"><%= @game.organizer_address  %></td>
      <% else %>
        <td><%= text_field :game, :organizer %></td>
        <td colspan="2"><%= text_field :game, :organizer_address %></td>
      <% end %>
    </tr>
    <tr>
      <th colspan="3">Message</th>
    </tr>
    <tr>
      <% if @view_only %>
        <td colspan="3"><%= @game.message  %></td>
      <% else %>
        <td colspan="3"><%= f.text_area :message, :rows =>3, :cols => 80 %></td>
      <% end %>
    </tr>
  </table>

  <% unless @view_only %>
    <%= entry_nav %>
  <% else %>
    <%= edit_nav(@game.id) %>    
  <% end %>

  <%= error_messages_for 'game' %>

  <br/>
  <table id="game_players">
    <caption>Players</caption>
    <thead>
      <tr>
        <th>Name</th>
        <th>Status</th>
        <th>Assignment</th>
        <th>Goalie</th>
      </tr>
    </thead>
    <tbody>
      <% for @game_player in @game.game_players %>
        <% if @view_only %>
          <tr>
            <td><%= @game_player.player.name %></td>
            <td><%= @game_player.player_status.description %></td>
            <td><%= @game_player.equipment.description %></td>
            <td><%= @game_player.goalie ? 'Yes' : (@game.on_deck==@game_player ? "On Deck" : "") %></td>
          </tr>
        <% else %>
          <% fields_for "game_player_#{@game_player.player_id}", @game_player do |gp_form| %>
            <tr>
              <td><%= @game_player.player.name %> <%= gp_form.hidden_field :player_id %> <%= gp_form.hidden_field :id %></td>
              <td><%= select_tag("game_player_#{@game_player.player_id}[player_status_id]", options_from_collection_for_select(@player_statuses, :id, :description, @game_player.player_status_id)) %></td>
              <td><%= select_tag("game_player_#{@game_player.player_id}[equipment_id]", options_from_collection_for_select(@equipment, :id, :description, @game_player.equipment_id)) %></td>
              <td><%= check_box("game_player_#{@game_player.player_id}", :goalie, :checked => @game_player.goalie? ? 'checked' : '') %></td>
            </tr>
          <% end %>
        <% end %>
      <% end %>
    </tbody>
  </table>

  <% unless @view_only %>
    <%= entry_nav %>
  <% end %>
<% end %>
